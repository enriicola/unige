<!-- https://2023.aulaweb.unige.it/mod/assign/view.php?id=134050 -->
<!-- Due: Saturday, 11 May 2024, 12:00 AM -->

# Welcome to the Automated Vulnerability Scanner by Enrico Pezzano!

As requested, in this README I'll guide you in the comprehension and proper execution of the mentioned tool üì°.

## TL;DR
> sh main.sh

### What does the script do?
The command above will launch a script that will execute the vulnerability scanner for you.
In particular, the script will:
- clear the terminal and print a welcome message
- install the necessary python packages
<!-- - TODO docker stuff -->
- execute the scanner (check the "Python script description" below)
- check if it has been executed correctly
   - if it has, it will print a success message ‚úÖ
   - if it has not, it will print an error message ‚ùå
- finally, it will open the output report file for you to check the results

## Python script description
Briefly, the python script will open the input yaml file, parse it, and save the results in a list of services by key and value, e.g.:
```
['service_type': 'wordpress', 'version': '5.2.3']
['service_type': 'apache', 'version': '2.4.29']
['service_type': 'mysql', 'version': '5.7.26']
['service_type': 'grafana', 'version': '6.2.5']
```
Then, it will ask you for additional and optional services to scan CVEs for.
- all managed via the python stdin and stdout
- if will loop for n times, where n is the number of services you wish to add
- at the end of every loop, it will append the newly built service to the list of services

Then, it will check the versions against a database of known vulnerabilities using the `scan_services` method.
The script will check for the versions of the given services automatically for:
- wordpress
- apache
- mysql
- ftp
- php
In particular, it will call the `get_version` method for each of the services above, evaluating the name of the method in funciton of the service type string, e.g.:
```
return eval(f'get_{<name of service>}_version'.lower())(full_url)
```

For every other additional service you wish to scan, it will scan for the version you added manually to the list.

Finally, it will save the results of the parsed values of the `nvdlib.searchCVE()` method to a file called `data`.

And of course, it will print the results to the terminal and generate the output file `report.pdf` according to the data gathered.


## Which are the files and the components of this assignment?

<!-- > **Dockerfile**:  -->

>  **README.md**: "It's me, Mario!" üçÑ

>  **input.yaml**: the input file where you can define the services to be scanned, by specifying the type, base_url, port.

>  **scanner.py**: the main script that will execute the vulnerability scanner for the given, and eventually additional, services.

> **data**: the output file that will be generated by from the scanner.py script.

>  **main.sh**: the shell script that is tailored to execute the scanner.py, after having installed the necessary python packages; it will print also colored messages to the terminal, to make the user experience more enjoyable.

>  **report.pdf**: you guessed it! The output report file that will be generated by the scanner.py script.

### That's all folks! üöÄ